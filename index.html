<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Panel de Control - Junta Semanal</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        :root { --pnd: #f39c12; --ok: #27ae60; --bg: #f0f2f5; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); padding: 20px; color: #333; }
        h1 { text-align: center; color: #1a3a5a; font-size: 1.8rem; text-transform: uppercase; margin-bottom: 30px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .card { background: white; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); overflow: hidden; border-top: 5px solid #3498db; }
        .card h2 { background: #f8f9fa; margin: 0; padding: 15px; font-size: 1rem; color: #2c3e50; border-bottom: 1px solid #eee; text-align: center; }
        .list { padding: 15px; min-height: 100px; }
        .item { padding: 10px; border-bottom: 1px solid #f1f1f1; margin-bottom: 8px; border-radius: 4px; background: #fff; border-left: 3px solid var(--pnd); }
        .item.done { border-left-color: var(--ok); opacity: 0.6; background: #f9fff9; }
        .item.done span { text-decoration: line-through; color: #888; }
        .st { font-size: 0.65rem; font-weight: bold; display: block; margin-top: 5px; text-transform: uppercase; }
        .st-p { color: var(--pnd); }
        .st-o { color: var(--ok); }
        .loading { text-align: center; font-weight: bold; color: #666; padding: 50px; }
    </style>
</head>
<body>

    <h1>üìù Seguimiento de Pendientes y Vendedores</h1>
    <div id="loading" class="loading">Sincronizando con Google Sheets...</div>
    <div class="grid" id="grid"></div>

    <script>
        // URL ACTUALIZADA
        const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTsePMc9flpt7FS7INMvVH4drQZAlpG96AqFOV7iQ0q2WO7g1H28MBM2SDkUN31gmY5agCDP4VoZrwx/pub?gid=0&single=true&output=csv';

        function load() {
            Papa.parse(csvUrl, {
                download: true,
                header: true,
                skipEmptyLines: true,
                complete: function(results) {
                    render(results.data);
                    document.getElementById('loading').style.display = 'none';
                },
                error: function() {
                    document.getElementById('loading').innerHTML = "‚ùå Error de conexi√≥n. Revisa que el link est√© publicado.";
                }
            });
        }

        function render(data) {
            const container = document.getElementById('grid');
            // Definimos exactamente las columnas de tu Excel
            const grupos = [
                { t: "JUNTAS SEMANAL", s: "ESESTATUS1", label: "üóìÔ∏è JUNTA SEMANAL" },
                { t: "TULANCINGO", s: "ESTATUS2", label: "üìç TULANCINGO" },
                { t: "CECI P.", s: "ESTATUS3", label: "üë§ CECI P." },
                { t: "ENRIQUE R.", s: "ESTATUS4", label: "üë§ ENRIQUE R." },
                { t: "OSCAR F.", s: "ESTATUS5", label: "üë§ OSCAR F." },
                { t: "CELENE S.", s: "ESTATUS6", label: "üë§ CELENE S." }
            ];

            grupos.forEach(g => {
                let html = `<div class="card"><h2>${g.label}</h2><div class="list">`;
                let count = 0;

                data.forEach(row => {
                    // Limpiamos los nombres de las columnas por si traen espacios o caracteres raros
                    const rowClean = {};
                    Object.keys(row).forEach(k => rowClean[k.trim()] = row[k]);

                    let tarea = rowClean[g.t];
                    let status = rowClean[g.s] ? rowClean[g.s].toLowerCase().trim() : "";

                    if (tarea && tarea.trim().length > 1) {
                        count++;
                        let isDone = (status === "cumplido" || status === "ok" || status === "hecho");
                        html += `
                            <div class="item ${isDone ? 'done' : ''}">
                                <span>${tarea}</span>
                                <b class="st ${isDone ? 'st-o' : 'st-p'}">${isDone ? '‚úì Terminado' : '‚è≥ Pendiente'}</b>
                            </div>`;
                    }
                });

                if(count === 0) html += `<p style="color:#ccc; font-size:0.8rem; text-align:center;">Sin tareas registradas</p>`;
                html += `</div></div>`;
                container.innerHTML += html;
            });
        }

        window.onload = load;
    </script>
</body>
</html>
